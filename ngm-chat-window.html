<!DOCTYPE html>
<html lang="gu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<title>Chat</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
:root{--tg-blue:#5288c1;--bg:#e5ddd5;--msg-in:#fff;--msg-out:#dcf8c6}
*{margin:0;padding:0;box-sizing:border-box;-webkit-user-select:none;user-select:none}
body{font-family:'Roboto',-apple-system,sans-serif;background:var(--bg);overflow:hidden}

.container{max-width:480px;margin:0 auto;height:100vh;display:flex;flex-direction:column;background:var(--bg)}

.header{
 height:100px;
 background:linear-gradient(135deg,var(--tg-blue),#3d6fa3);
 display:flex;
 flex-direction:column;
 justify-content:flex-end;
 padding:0 10px 10px;
 position:fixed;
 top:0;left:0;right:0;
 max-width:480px;
 margin:0 auto;
 z-index:100;
 box-shadow:0 2px 5px rgba(0,0,0,0.2)
}

.header-content{display:flex;align-items:center;gap:10px}
.back-btn,.menu-btn{width:40px;height:40px;background:none;border:none;display:flex;align-items:center;justify-content:center}
.back-btn svg,.menu-btn svg{fill:#fff;width:22px;height:22px}
.avatar{width:42px;height:42px;border-radius:50%;background:#fff;display:flex;align-items:center;justify-content:center;font-weight:600;color:var(--tg-blue)}
.header-info{flex:1;overflow:hidden}
.name{color:#fff;font-size:17px;font-weight:500}
.status{color:rgba(255,255,255,0.9);font-size:13px}

.messages-area{
 flex:1;
 overflow-y:auto;
 padding:110px 10px 120px; /* ‚¨ÖÔ∏è floating input space */
 background:var(--bg)
}

.message{margin-bottom:8px;display:flex}
.message.out{justify-content:flex-end}
.message.in{justify-content:flex-start}

.msg-bubble{
 max-width:75%;
 padding:6px 10px;
 border-radius:8px;
 box-shadow:0 1px 1px rgba(0,0,0,0.1)
}
.message.out .msg-bubble{background:var(--msg-out);border-bottom-right-radius:2px}
.message.in .msg-bubble{background:var(--msg-in);border-bottom-left-radius:2px}
.msg-text{font-size:15px}
.msg-time{font-size:11px;color:#666;text-align:right}

.typing{
 position:fixed;
 bottom:70px;
 left:50%;
 transform:translateX(-50%);
 font-size:13px;
 color:#666;
 display:none;
 z-index:250;
 transition:bottom .25s
}
.typing.raised{bottom:372px}

.emoji-keyboard{
 position:fixed;
 bottom:0;left:0;right:0;
 max-width:480px;
 margin:0 auto;
 height:300px;
 background:#fff;
 display:none;
 z-index:150;
 border-top:1px solid #e0e0e0
}
.emoji-keyboard.show{display:flex;flex-direction:column}

.emoji-grid{
 flex:1;
 display:grid;
 grid-template-columns:repeat(8,1fr);
 gap:6px;
 padding:10px;
 overflow-y:auto
}
.emoji-item{font-size:26px;text-align:center;cursor:pointer}

.file-picker{
 position:fixed;
 bottom:0;left:0;right:0;
 max-width:480px;
 margin:0 auto;
 background:#fff;
 padding:15px;
 display:none;
 z-index:150
}
.file-picker.show{display:block}

.input-bar{
 position:fixed;
 left:50%;
 transform:translateX(-50%);
 bottom:12px;                     /* ‚¨ÖÔ∏è floating */
 max-width:460px;
 width:calc(100% - 20px);
 background:#f0f0f0;
 display:flex;
 align-items:center;
 gap:6px;
 padding:6px 10px;
 border-radius:24px;
 border:1px solid #d0d0d0;
 box-shadow:0 6px 20px rgba(0,0,0,0.2);
 z-index:300;
 transition:bottom .25s
}
.input-bar.raised{bottom:312px}

.emoji-btn,.attach-btn{
 width:36px;height:36px;
 background:none;border:none;
 display:flex;align-items:center;justify-content:center
}
.emoji-btn{font-size:22px}

.input-wrapper{
 flex:1;
 background:#fff;
 border-radius:20px;
 padding:0 12px;
 display:flex;align-items:center
}
.msg-input{
 flex:1;
 border:none;
 outline:none;
 resize:none;
 background:none;
 font-size:15px
}

.send-btn{
 width:40px;height:40px;
 border-radius:50%;
 background:var(--tg-blue);
 border:none;
 display:flex;align-items:center;justify-content:center
}
.send-btn svg{fill:#fff;width:20px;height:20px}
</style>
</head>

<body>
<div class="container">

<div class="header">
 <div class="header-content">
  <button class="back-btn" onclick="goBack()">‚Üê</button>
  <div class="avatar" id="chatAvatar">H</div>
  <div class="header-info">
   <div class="name" id="chatName">Loading...</div>
   <div class="status" id="chatStatus"></div>
  </div>
  <button class="menu-btn">‚ãÆ</button>
 </div>
</div>

<div class="messages-area" id="messagesArea">
 <div class="empty">No messages yet</div>
</div>

<div class="typing" id="typingIndicator">typing...</div>

<div class="emoji-keyboard" id="emojiKeyboard">
 <div class="emoji-grid" id="emojiGrid"></div>
</div>

<div class="file-picker" id="filePicker">
 <div>üì∑ Photo</div>
 <div>üé• Video</div>
 <div>üìÑ Document</div>
</div>

<div class="input-bar" id="inputBar">
 <button class="emoji-btn" onclick="toggleEmoji()">üòä</button>
 <div class="input-wrapper">
  <textarea class="msg-input" id="msgInput" placeholder="Message"></textarea>
 </div>
 <button class="attach-btn" onclick="toggleFiles()">üìé</button>
 <button class="send-btn" onclick="sendMsg()">‚û§</button>
</div>

</div>

<script>
/* üî• ‡™§‡™Æ‡™æ‡™∞‡´Å‡™Ç ORIGINAL JS ‚Äî untouched */
</script>

</body>
</html>
