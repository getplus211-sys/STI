<!DOCTYPE html>
<html lang="gu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STI Mock Test - 1 | Kapil Institute (Paid Content)</title>
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }
        /* આ ID #paid-content-area માં મૂકેલું તમારું બધું કન્ટેન્ટ છુપાવશે */
        #paid-content-area { 
            display: none; 
            border: 2px solid #007bff;
            padding: 20px;
            margin-top: 20px;
            background-color: #f8f9fa;
        }
        h1 {
            color: #007bff;
        }
    </style>
</head>
<body>

<script>
    // તમારી Supabase URL અને ANON KEY નો ઉપયોગ કરો
    const SUPABASE_URL = 'https://bhmycvrbucmbbrpzeane.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJobXljdnJidWNtYmJycHplYW5lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ2OTQwOTYsImV4cCI6MjA4MDI3MDA5Nn0.qQ3bw9cADG0P8hbGwx76Oeg54l-9FbRWxc92nZdSPL4';
    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    async function checkAccess() {
        // 1. ચેક કરો કે યુઝર લોગિન છે
        const { data: { session } } = await supabase.auth.getSession();
        
        if (!session) {
            alert("કૃપા કરીને પહેલા લોગિન કરો.");
            // હોમ પેજ પર પાછું મોકલો
            window.location.href = '/index.html'; 
            return;
        }

        // 2. 'user_access' ટેબલમાં 'STI_MOCK_TEST' એક્સેસ ચેક કરો
        const { data: accessData } = await supabase
            .from('user_access')
            .select('is_active')
            .eq('user_id', session.user.id)
            .eq('access_type', 'STI_MOCK_TEST') 
            .maybeSingle(); 

        // 3. એક્સેસ આપો કે ન આપો
        if (accessData && accessData.is_active === true) {
            // એક્સેસ મળી ગયો: કન્ટેન્ટ બતાવો
            document.getElementById('paid-content-area').style.display = 'block';
        } else {
            // એક્સેસ નથી: યુઝરને ખરીદી પેજ પર પાછો મોકલો
            alert("આ કન્ટેન્ટ જોવા માટે તમારે 'STI 5 Mock Test Series' ખરીદવાની જરૂર છે.");
            window.location.href = '/index.html'; 
        }
    }

    // પેજ લોડ થાય ત્યારે એક્સેસ ચેક કરો
    document.addEventListener('DOMContentLoaded', checkAccess);
</script>


<div id="paid-content-area">
    <h1>STI Mock Test - 1 (પેઇડ કન્ટેન્ટ)</h1>
    <p>અભિનંદન! તમારો એક્સેસ સફળ છે. તમે આ કન્ટેન્ટ જોઈ શકો છો.</p>
    
    <p>આ પેજમાં, આ લાઇન પછી તમારી મોક ટેસ્ટનું સંપૂર્ણ HTML કન્ટેન્ટ આવશે.</p>
    <p>જો યુઝરે પેમેન્ટ નહીં કર્યું હોય, તો આ Div દેખાશે નહીં.</p>
    
    </div>

</body>
</html>
