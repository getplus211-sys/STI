<!DOCTYPE html>
<html lang="gu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KAPiLa Learning - Digital Learning Platform</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:sans-serif;background:#f3f4f6;padding-top:105px;padding-bottom:70px}

/* Header àª¸à«àªŸàª¾àª‡àª² - àª«à«‹àªŸà«‹ àª®à«àªœàª¬ */
.header{
  position:fixed;
  top:0;
  left:0;
  right:0;
  z-index:1000;
  background:linear-gradient(135deg,#8b5cf6,#7c3aed);
  padding:0 12px 12px 12px;
  box-shadow:0 2px 10px rgba(139,92,246,0.3);
  min-height:95px;
  display:flex;
  align-items:flex-end;
}
.header-content{
  display:flex;
  justify-content:space-between;
  align-items:center;
  max-width:600px;
  margin:0 auto;
  width:100%;
  padding-bottom:2px;
}
.brand{flex:1}
.brand-name{
  font-size:20px;
  font-weight:900;
  color:#fff;
  line-height:1.2;
  letter-spacing:0.3px;
}
.brand-subtitle{
  font-size:10px;
  color:rgba(255,255,255,0.9);
  margin-top:2px;
}
.header-right{
  display:flex;
  align-items:center;
  gap:8px;
}
.user-name{
  font-size:13px;
  font-weight:bold;
  color:#fff;
  max-width:120px;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}
.menu-btn{
  width:40px;
  height:40px;
  background:transparent;
  border:none;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:5px;
  cursor:pointer;
  padding:8px;
}
.menu-btn span{
  width:24px;
  height:2.5px;
  background:#fff;
  border-radius:2px;
  transition:all 0.3s;
}

/* Footer àª¸à«àªŸàª¾àª‡àª² - àª«à«‹àªŸà«‹ àª®à«àªœàª¬ */
.footer{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  z-index:1000;
  background:#fff;
  padding:6px 0;
  box-shadow:0 -2px 10px rgba(0,0,0,0.1);
  border-top:1px solid #e5e7eb;
}
.footer-nav{
  display:flex;
  justify-content:space-around;
  align-items:center;
  max-width:600px;
  margin:0 auto;
}
.footer-btn{
  background:none;
  border:none;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:3px;
  cursor:pointer;
  padding:6px 10px;
  flex:1;
  position:relative;
  transition:all 0.2s;
  text-decoration:none;
}
.footer-btn:active{
  transform:scale(0.95);
}
.footer-icon{
  width:28px;
  height:28px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:24px;
}
.footer-btn svg{
  width:24px;
  height:24px;
  stroke:#1f2937;
  stroke-width:2;
  fill:none;
  transition:all 0.2s;
}
.footer-btn.active .footer-icon{
  color:#8b5cf6;
}
.footer-btn.active svg{
  stroke:#8b5cf6;
}
.footer-label{
  font-size:10px;
  font-weight:600;
  color:#1f2937;
  transition:all 0.2s;
}
.footer-btn.active .footer-label{
  color:#8b5cf6;
}
.notification-badge{
  position:absolute;
  top:4px;
  right:8px;
  background:#ef4444;
  color:#fff;
  font-size:9px;
  padding:2px 5px;
  border-radius:10px;
  font-weight:bold;
  min-width:18px;
  text-align:center;
}

.container{padding:0 16px;max-width:600px;margin:0 auto}
.container a, .container button{cursor:pointer;pointer-events:auto}
.container *{pointer-events:auto}
.side-menu{position:fixed;top:0;right:-280px;width:280px;height:100%;background:#fff;z-index:2000;transition:right 0.3s;box-shadow:-2px 0 10px rgba(0,0,0,0.1);overflow-y:auto}
.side-menu.open{right:0}
.menu-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);z-index:1999;display:none}
.menu-overlay.show{display:block}
.menu-header{padding:20px;background:linear-gradient(135deg,#8b5cf6,#7c3aed);color:#fff;position:relative}
.menu-header h3{font-size:18px;margin-bottom:4px}
.menu-header p{font-size:12px;opacity:0.9}
.menu-close{position:absolute;top:20px;right:20px;background:rgba(255,255,255,0.2);border:none;color:#fff;font-size:24px;width:32px;height:32px;border-radius:8px;cursor:pointer}
.menu-items{padding:12px 0}
.menu-item{padding:16px 20px;border-bottom:1px solid #f3f4f6;cursor:pointer;display:flex;align-items:center;gap:12px}
.menu-item:hover{background:#f9fafb}
.menu-icon{font-size:24px;width:40px;text-align:center}
.modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.6);z-index:3000;align-items:center;justify-content:center;padding:20px;overflow-y:auto}
.modal.show{display:flex}
.modal-content{background:#fff;border-radius:16px;max-width:400px;width:100%;padding:24px;max-height:90vh;overflow-y:auto;margin:auto}
.modal-header{display:flex;align-items:center;margin-bottom:20px}
.modal-logo{width:50px;height:50px;background:linear-gradient(135deg,#ea580c,#dc2626);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:24px;margin-right:12px;flex-shrink:0}
.modal-title-wrap{flex:1}
.modal-brand{font-size:18px;font-weight:bold;color:#ea580c}
.modal-subtitle{font-size:11px;color:#6b7280}
</style>
</head>
<body>

<header class="header">
  <div class="header-content">
    <div class="brand">
      <div class="brand-name">KAPiLa Learning</div>
      <div class="brand-subtitle">Digital Learning Platform</div>
    </div>
    <div class="header-right">
      <span id="userNameDisplay" class="user-name" style="display:none"></span>
      <button class="menu-btn" onclick="toggleMenu()">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </div>
</header>

<div class="container" id="content">
  <div style="text-align:center;padding:40px 20px;color:#6b7280">
    <h3>àª²à«‹àª¡ àª¥àªˆ àª°àª¹à«àª¯à«àª‚ àª›à«‡...</h3>
  </div>
</div>

<footer class="footer">
  <div class="footer-nav">
    <button class="footer-btn active" onclick="navigateFooter('home')">
      <div class="footer-icon">
        ğŸ 
      </div>
      <span class="footer-label">Home</span>
    </button>
    <button class="footer-btn" onclick="navigateFooter('performance')">
      <div class="footer-icon">
        <svg viewBox="0 0 24 24"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></svg>
      </div>
      <span class="footer-label">Performance</span>
    </button>
    <a href="account.html" class="footer-btn">
      <div class="footer-icon">
        <svg viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
      </div>
      <span class="footer-label">Account</span>
    </a>
    <button class="footer-btn" onclick="navigateFooter('contact')">
      <div class="footer-icon">
        <svg viewBox="0 0 24 24"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
      </div>
      <span class="footer-label">Contact</span>
    </button>
    <button class="footer-btn" onclick="navigateFooter('notification')">
      <div class="footer-icon">
        <svg viewBox="0 0 24 24"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>
      </div>
      <span class="footer-label">Notifications</span>
      <span id="notificationBadge" class="notification-badge" style="display:none">0</span>
    </button>
  </div>
</footer>

<div class="menu-overlay" id="menuOverlay" onclick="toggleMenu()"></div>
<div class="side-menu" id="sideMenu">
  <div class="menu-header">
    <button class="menu-close" onclick="toggleMenu()">Ã—</button>
    <h3>KAPiLa Learning</h3>
    <p>Digital Learning Platform</p>
  </div>
  <div class="menu-items">
    <div class="menu-item" onclick="menuNavigate('home')">
      <span class="menu-icon">ğŸ </span>
      <span>Home</span>
    </div>
    <div class="menu-item" onclick="menuNavigate('about')">
      <span class="menu-icon">â„¹ï¸</span>
      <span>About Us</span>
    </div>
    <div class="menu-item" onclick="menuNavigate('privacy')">
      <span class="menu-icon">ğŸ”’</span>
      <span>Privacy Policy</span>
    </div>
    <div class="menu-item" onclick="menuNavigate('terms')">
      <span class="menu-icon">ğŸ“„</span>
      <span>Terms & Conditions</span>
    </div>
    <div class="menu-item" onclick="menuNavigate('contact')">
      <span class="menu-icon">ğŸ“</span>
      <span>Contact Us</span>
    </div>
    <div class="menu-item" id="logoutMenuItem" style="display:none" onclick="handleLogout()">
      <span class="menu-icon">ğŸšª</span>
      <span>Logout</span>
    </div>
  </div>
</div>

<!-- Contact Modal -->
<div class="modal" id="contactModal">
  <div class="modal-content">
    <div class="modal-header">
      <div class="modal-logo">ğŸ“</div>
      <div class="modal-title-wrap">
        <div class="modal-brand">KAPiLa Learning</div>
        <div class="modal-subtitle">Digital Learning Platform</div>
      </div>
    </div>
    <h3 style="font-size:18px;font-weight:bold;margin-bottom:16px;text-align:center">ğŸ“ Contact Us</h3>
    <p style="text-align:center;color:#6b7280;font-size:13px;margin-bottom:20px">+91 6353511804</p>
    <a href="https://wa.me/916353511804?text=Hello%20KAPiLa%20Institute" target="_blank" style="display:block;width:100%;background:#22c55e;color:#fff;padding:14px;border-radius:12px;text-align:center;font-weight:bold;text-decoration:none;margin-bottom:12px;font-size:14px">
      WhatsApp
    </a>
    <a href="tel:+916353511804" style="display:block;width:100%;background:#2563eb;color:#fff;padding:14px;border-radius:12px;text-align:center;font-weight:bold;text-decoration:none;font-size:14px">
      Call
    </a>
    <button style="width:100%;background:#f3f4f6;color:#1f2937;padding:12px;border-radius:8px;font-size:14px;font-weight:600;border:none;cursor:pointer;margin-top:12px" onclick="closeContactModal()">àª¬àª‚àª§ àª•àª°à«‹</button>
  </div>
</div>

<!-- About Us Modal -->
<div class="modal" id="aboutModal">
  <div class="modal-content">
    <div class="modal-header">
      <div class="modal-logo">ğŸ“</div>
      <div class="modal-title-wrap">
        <div class="modal-brand">KAPiLa Learning</div>
        <div class="modal-subtitle">Digital Learning Platform</div>
      </div>
    </div>
    <h3 style="font-size:18px;font-weight:bold;margin-bottom:16px;text-align:center">â„¹ï¸ About KAPiLa Learning</h3>
    <div style="color:#374151;font-size:14px;line-height:1.8;text-align:justify">
      <p style="margin-bottom:12px">KAPiLa Learning is a leading educational platform dedicated to helping students prepare for competitive government examinations including GPSC, CCE, PSI, Police, Talati, and other state-level exams.</p>
      <p style="margin-bottom:12px">We provide comprehensive study materials, mock tests, and performance analytics to ensure students achieve their dreams of securing government jobs.</p>
      <p style="margin-bottom:12px">Our expert faculty and innovative digital learning approach make exam preparation accessible, effective, and affordable for every student.</p>
      <p style="margin-bottom:12px">With thousands of successful students, KAPiLa Learning has become a trusted name in competitive exam preparation across Gujarat.</p>
      <p>Join us today and take the first step towards your successful career in government service!</p>
    </div>
    <button style="width:100%;background:#8b5cf6;color:#fff;padding:12px;border-radius:8px;font-size:14px;font-weight:bold;border:none;cursor:pointer;margin-top:20px" onclick="closeAboutModal()">àª¬àª‚àª§ àª•àª°à«‹</button>
  </div>
</div>

<!-- Notification Modal -->
<div class="modal" id="notificationModal">
  <div class="modal-content">
    <div class="modal-header">
      <div class="modal-logo">ğŸ””</div>
      <div class="modal-title-wrap">
        <div class="modal-brand">KAPiLa Learning</div>
        <div class="modal-subtitle">Notifications</div>
      </div>
    </div>
    <h3 style="font-size:18px;font-weight:bold;margin-bottom:16px;text-align:center">ğŸ”” Notifications</h3>
    <div id="notificationList">
      <div style="text-align:center;padding:30px 20px;color:#9ca3af">
        <div style="font-size:48px;margin-bottom:12px">ğŸ”•</div>
        <p style="font-size:14px">àª•à«‹àªˆ notifications àª¨àª¥à«€</p>
        <p style="font-size:12px;margin-top:8px">àª¤àª®àª¾àª°àª¾ àª¨àªµàª¾ notifications àª…àª¹à«€àª‚ àª¦à«‡àª–àª¾àª¶à«‡</p>
      </div>
    </div>
    <button style="width:100%;background:#f3f4f6;color:#1f2937;padding:12px;border-radius:8px;font-size:14px;font-weight:600;border:none;cursor:pointer;margin-top:12px" onclick="closeNotificationModal()">àª¬àª‚àª§ àª•àª°à«‹</button>
  </div>
</div>

<script>
const SUPABASE_URL = "https://bhmycvrbucmbbrpzeane.supabase.co";
const SUPABASE_ANON = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJobXljdnJidWNtYmJycHplYW5lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ2OTQwOTYsImV4cCI6MjA4MDI3MDA5Nn0.qQ3bw9cADG0P8hbGwx76Oeg54l-9FbRWxc92nZdSPL4";
const sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON);
let currentUser = null;

async function init() {
  await checkAuth();
  if (!currentUser) {
    window.location.href = 'login.html';
    return;
  }
  await loadHomePage();
}

async function checkAuth() {
  const { data: { user } } = await sb.auth.getUser();
  if (user) {
    currentUser = user;
    document.getElementById('userNameDisplay').style.display = 'block';
    document.getElementById('logoutMenuItem').style.display = 'flex';
    
    const { data: profile } = await sb.from('profiles').select('*').eq('id', user.id).single();
    document.getElementById('userNameDisplay').innerText = profile?.full_name || user.email.split('@')[0];
  }
}

async function loadHomePage() {
  try {
    const { data, error } = await sb.from('home_page_blocks').select('*').eq('is_active', true).order('display_order');
    if (error) throw error;
    document.getElementById('content').innerHTML = data && data.length > 0 ? data.map(block => block.block_html).join('') : '<div style="text-align:center;padding:40px 20px"><h3>àª•à«‹àªˆ content àª¨àª¥à«€</h3></div>';
  } catch (err) {
    console.error('Error:', err);
    document.getElementById('content').innerHTML = '<div style="text-align:center;padding:40px 20px;color:#ef4444"><h3>Error</h3><p>' + err.message + '</p></div>';
  }
}

function toggleMenu() {
  document.getElementById('sideMenu').classList.toggle('open');
  document.getElementById('menuOverlay').classList.toggle('show');
}

function menuNavigate(page) {
  toggleMenu();
  if (page === 'home') window.location.href = 'index-kapila.html';
  else if (page === 'about') showAboutPopup();
  else if (page === 'privacy') window.location.href = 'privacy-policy.html';
  else if (page === 'terms') window.location.href = 'terms-and-conditions.html';
  else if (page === 'contact') showContactPopup();
}

function navigateFooter(page) {
  document.querySelectorAll('.footer-btn').forEach(btn => btn.classList.remove('active'));
  event.target.closest('.footer-btn').classList.add('active');
  
  if (page === 'home') window.location.href = 'index-kapila.html';
  else if (page === 'performance') window.location.href = 'overall-performance.html';
  else if (page === 'contact') showContactPopup();
  else if (page === 'notification') showNotificationPopup();
}

async function handleLogout() {
  await sb.auth.signOut();
  window.location.href = 'login.html';
}

function showContactPopup() {
  document.getElementById('contactModal').classList.add('show');
}

function closeContactModal() {
  document.getElementById('contactModal').classList.remove('show');
}

function showAboutPopup() {
  document.getElementById('aboutModal').classList.add('show');
}

function closeAboutModal() {
  document.getElementById('aboutModal').classList.remove('show');
}

function showNotificationPopup() {
  document.getElementById('notificationModal').classList.add('show');
}

function closeNotificationModal() {
  document.getElementById('notificationModal').classList.remove('show');
}

init();
</script>
</body>
</html>
