<!DOCTYPE html>
<html lang="gu">
<head>
<meta charset="UTF-8">
<title>KAPiLa Institute - Home</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:system-ui;background:#f1f5f9}
.container{max-width:1200px;margin:auto;padding:20px}
.loader{text-align:center;padding:60px;color:#64748b}
</style>
</head>
<body>
<div class="container" id="app">
  <div class="loader">
    <h2>લોડ થઈ રહ્યું છે...</h2>
    <p>કૃપા કરીને રાહ જુઓ</p>
  </div>
</div>

<script>
const SUPABASE_URL = "https://bhmycvrbucmbbrpzeane.supabase.co";
const SUPABASE_ANON = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJobXljdnJidWNtYmJycHplYW5lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ2OTQwOTYsImV4cCI6MjA4MDI3MDA5Nn0.qQ3bw9cADG0P8hbGwx76Oeg54l-9FbRWxc92nZdSPL4";
const sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON);

async function loadHomePage() {
  try {
    // માત્ર એક જ query - display_order થી sorted
    const { data, error } = await sb
      .from('home_page_blocks')
      .select('*')
      .eq('is_active', true)
      .order('display_order', { ascending: true });
    
    if (error) throw error;
    
    // બધા blocks નો HTML એક પછી એક display કરો
    let html = '';
    if (data) {
      data.forEach(block => {
        html += block.block_html;
      });
    }
    
    document.getElementById('app').innerHTML = html;
    
  } catch (err) {
    console.error('Error:', err);
    document.getElementById('app').innerHTML = '<div class="loader"><h2>❌ Error</h2><p>ડેટા લોડ કરવામાં સમસ્યા</p></div>';
  }
}

loadHomePage();
</script>
</body>
</html>
