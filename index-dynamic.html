<!DOCTYPE html>
<html lang="gu">
<head>
<meta charset="UTF-8">
<title>KAPiLa Institute - LRD Beginners</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:system-ui;background:#f1f5f9}
.container{max-width:1200px;margin:auto;padding:20px}

/* Hero Section */
.hero{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;padding:80px 20px;text-align:center;border-radius:20px;margin-bottom:40px}
.hero h1{font-size:48px;margin-bottom:20px;text-shadow:0 2px 10px rgba(0,0,0,0.3)}
.hero p{font-size:20px;margin-bottom:30px;opacity:0.9}
.hero-cta{background:#fff;color:#667eea;padding:15px 40px;border-radius:50px;font-size:18px;font-weight:bold;text-decoration:none;display:inline-block;transition:all 0.3s;box-shadow:0 4px 15px rgba(0,0,0,0.2)}
.hero-cta:hover{transform:translateY(-3px);box-shadow:0 6px 20px rgba(0,0,0,0.3)}

/* Announcements */
.announcements{margin-bottom:40px}
.announcement{background:#fff;padding:15px 20px;border-radius:12px;margin-bottom:15px;border-left:4px solid #3b82f6;box-shadow:0 2px 10px rgba(0,0,0,0.05)}
.announcement.success{border-left-color:#22c55e}
.announcement.warning{border-left-color:#f59e0b}
.announcement.info{border-left-color:#3b82f6}
.announcement h3{font-size:16px;margin-bottom:5px;color:#1e293b}
.announcement p{font-size:14px;color:#64748b}

/* Statistics */
.stats{display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-bottom:40px}
.stat-card{background:#fff;padding:30px;border-radius:16px;text-align:center;box-shadow:0 4px 15px rgba(0,0,0,0.08);transition:all 0.3s}
.stat-card:hover{transform:translateY(-5px);box-shadow:0 8px 25px rgba(0,0,0,0.12)}
.stat-icon{font-size:40px;margin-bottom:15px}
.stat-value{font-size:32px;font-weight:bold;color:#1e293b;margin-bottom:5px}
.stat-label{font-size:14px;color:#64748b}

/* Section Title */
.section-title{font-size:32px;font-weight:bold;color:#1e293b;margin:60px 0 30px;text-align:center;position:relative}
.section-title:after{content:'';width:60px;height:4px;background:linear-gradient(90deg,#667eea,#764ba2);display:block;margin:15px auto 0}

/* Features/Blocks Grid */
.blocks-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-bottom:40px}
.block-card{background:#fff;padding:25px;border-radius:16px;text-align:center;box-shadow:0 4px 15px rgba(0,0,0,0.08);transition:all 0.3s;cursor:pointer}
.block-card:hover{transform:translateY(-5px);box-shadow:0 8px 25px rgba(0,0,0,0.12)}
.block-icon{font-size:50px;margin-bottom:15px}
.block-title{font-size:20px;font-weight:bold;color:#1e293b;margin-bottom:8px}
.block-subtitle{font-size:12px;color:#3b82f6;margin-bottom:10px;font-weight:600}
.block-description{font-size:14px;color:#64748b;margin-bottom:15px;line-height:1.5}
.block-link{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:10px 20px;border-radius:25px;font-size:14px;font-weight:600;text-decoration:none;display:inline-block;transition:all 0.3s}
.block-link:hover{transform:scale(1.05)}

/* Subjects Grid */
.subjects-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-bottom:60px}
.subject-card{background:#fff;padding:25px;border-radius:16px;box-shadow:0 4px 15px rgba(0,0,0,0.08);transition:all 0.3s;cursor:pointer}
.subject-card:hover{transform:translateY(-5px);box-shadow:0 8px 25px rgba(0,0,0,0.12)}
.subject-header{display:flex;align-items:center;gap:15px;margin-bottom:15px}
.subject-icon{font-size:40px}
.subject-title{font-size:18px;font-weight:bold;color:#1e293b}
.subject-description{font-size:14px;color:#64748b;margin-bottom:15px;line-height:1.5}
.subject-meta{display:flex;justify-content:space-between;padding-top:15px;border-top:1px solid #e5e7eb;font-size:13px;color:#64748b}

/* Loading */
.loader{text-align:center;padding:60px;color:#64748b}

/* Responsive */
@media (max-width:768px){
.hero h1{font-size:32px}
.hero p{font-size:16px}
.stats{grid-template-columns:repeat(2,1fr)}
.blocks-grid{grid-template-columns:repeat(2,1fr)}
.subjects-grid{grid-template-columns:1fr}
.section-title{font-size:24px}
}
</style>
</head>
<body>
<div class="container" id="app">
  <div class="loader">
    <h2>àª²à«‹àª¡ àª¥àªˆ àª°àª¹à«àª¯à«àª‚ àª›à«‡...</h2>
    <p>àª•à«ƒàªªàª¾ àª•àª°à«€àª¨à«‡ àª°àª¾àª¹ àªœà«àª“</p>
  </div>
</div>

<script>
const SUPABASE_URL = "https://bhmycvrbucmbbrpzeane.supabase.co";
const SUPABASE_ANON = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJobXljdnJidWNtYmJycHplYW5lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ2OTQwOTYsImV4cCI6MjA4MDI3MDA5Nn0.qQ3bw9cADG0P8hbGwx76Oeg54l-9FbRWxc92nZdSPL4";
const sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON);

let app = document.getElementById("app");

async function init() {
  try {
    // Load all data in parallel
    const [hero, announcements, stats, blocks, subjects] = await Promise.all([
      sb.from('home_hero_section').select('*').eq('is_active', true).order('display_order').limit(1).single(),
      sb.from('home_announcements').select('*').eq('is_active', true).order('display_order'),
      sb.from('home_statistics').select('*').eq('is_active', true).order('display_order'),
      sb.from('home_blocks').select('*').eq('is_active', true).order('display_order'),
      sb.from('home_subjects').select('*, lrd_subjects(name)').eq('is_active', true).order('display_order')
    ]);

    displayHomePage(hero.data, announcements.data, stats.data, blocks.data, subjects.data);
  } catch (err) {
    console.error('Error loading data:', err);
    app.innerHTML = '<div class="loader"><h2>âŒ Error</h2><p>àª¡à«‡àªŸàª¾ àª²à«‹àª¡ àª•àª°àªµàª¾àª®àª¾àª‚ àª¸àª®àª¸à«àª¯àª¾</p></div>';
  }
}

function displayHomePage(hero, announcements, stats, blocks, subjects) {
  let html = '';

  // Hero Section
  if (hero) {
    html += `
    <div class="hero">
      <h1>${hero.title}</h1>
      <p>${hero.subtitle || ''}</p>
      ${hero.cta_text ? `<a href="${hero.cta_link || '#'}" class="hero-cta">${hero.cta_text}</a>` : ''}
    </div>
    `;
  }

  // Announcements
  if (announcements && announcements.length > 0) {
    html += '<div class="announcements">';
    announcements.forEach(ann => {
      html += `
      <div class="announcement ${ann.type}">
        <h3>${ann.title}</h3>
        <p>${ann.content}</p>
      </div>
      `;
    });
    html += '</div>';
  }

  // Statistics
  if (stats && stats.length > 0) {
    html += '<div class="stats">';
    stats.forEach(stat => {
      html += `
      <div class="stat-card">
        <div class="stat-icon">${stat.icon || 'ğŸ“Š'}</div>
        <div class="stat-value">${stat.stat_value}</div>
        <div class="stat-label">${stat.stat_label}</div>
      </div>
      `;
    });
    html += '</div>';
  }

  // Feature Blocks
  if (blocks && blocks.length > 0) {
    html += '<h2 class="section-title">àª…àª®àª¾àª°à«€ àª¸à«àªµàª¿àª§àª¾àª“</h2>';
    html += '<div class="blocks-grid">';
    blocks.forEach(block => {
      html += `
      <div class="block-card" onclick="window.location.href='${block.link_url || '#'}'">
        <div class="block-icon">${block.icon || 'ğŸ“¦'}</div>
        <div class="block-title">${block.title}</div>
        ${block.subtitle ? `<div class="block-subtitle">${block.subtitle}</div>` : ''}
        <div class="block-description">${block.description || ''}</div>
        ${block.link_text ? `<a href="${block.link_url || '#'}" class="block-link">${block.link_text}</a>` : ''}
      </div>
      `;
    });
    html += '</div>';
  }

  // Subject Corner
  if (subjects && subjects.length > 0) {
    html += '<h2 class="section-title">Subject Corner</h2>';
    html += '<div class="subjects-grid">';
    subjects.forEach(subj => {
      const subjName = subj.lrd_subjects?.name || subj.title;
      html += `
      <div class="subject-card">
        <div class="subject-header">
          <div class="subject-icon">${subj.icon || 'ğŸ“š'}</div>
          <div class="subject-title">${subjName}</div>
        </div>
        <div class="subject-description">${subj.description || ''}</div>
        <div class="subject-meta">
          <span>ğŸ“ ${subj.total_questions || 0} àªªà«àª°àª¶à«àª¨à«‹</span>
          <span>ğŸ¯ Practice Ready</span>
        </div>
      </div>
      `;
    });
    html += '</div>';
  }

  app.innerHTML = html;
}

init();
</script>
</body>
</html>
