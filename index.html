<!DOCTYPE html>
<html lang="gu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STI Mock Test - Test Series</title>

    <style>
        /* ======================================= */
        /* Q1 FIX: Netlify Widget Z-Index Override */
        /* ======================================= */
        /* Widget ને હંમેશા ટોચ પર રાખવા માટે */
        .netlify-identity-widget {
            /* 99999 એ ઉચ્ચતમ કિંમત છે */
            z-index: 99999 !important; 
        }
        .netlify-identity-widget dialog::backdrop {
            z-index: 99998 !important; 
        }

        :root{
            --primary:#004d99;
            --accent:#ff6600;
            --success:#00a000;
            --bg:#f4f6f9;
        }

        body{
            margin:0;
            min-height:100vh;
            display:flex;
            flex-direction:column;
            font-family:Arial, sans-serif;
            background:var(--bg);
        }

        /* HEADER */
        .header{
            background:var(--primary);
            color:#fff;
            padding:12px 18px;
            display:flex;
            justify-content:space-between;
            align-items:center;
            position:sticky;
            top:0;
            /* Q1 FIX: હેડરનો z-index 99999 કરતા ઓછો રાખો */
            z-index: 1000; 
        }
        .header h1{
            margin:0;
            font-size:20px;
            font-weight:700;
        }
        .nav-link{
            color:#fff;
            text-decoration:none;
            margin-left:15px;
            font-size:15px;
            font-weight:bold;
        }

        /* CONTAINER */
        .container{
            width:92%;
            max-width:650px;
            margin:18px auto;
            flex:1; /* pushes footer down */
        }

        /* TEST BLOCK CARD */
        .test-block{
            background:#fff;
            padding:18px;
            border-radius:10px;
            margin-bottom:18px;
            box-shadow:0 4px 12px rgba(0,0,0,0.08);
        }
        .test-block h2{
            margin-top:0;
            color:var(--primary);
            font-size:19px;
        }
        .test-block p{
            line-height:1.55;
        }

        /* BUTTONS */
        .btn{
            display:inline-block;
            padding:10px 16px;
            border-radius:6px;
            border:none;
            cursor:pointer;
            font-size:15px;
            font-weight:bold;
            text-align:center;
            text-decoration:none;
        }
        .btn-accent{ background:var(--accent); color:#fff; }
        .btn-success{ background:var(--success); color:#fff; }

        /* NEW FOOTER UI */
        .footer{
            background:linear-gradient(135deg, #003b7a, #0074d9);
            padding:20px 10px;
            text-align:center;
            color:#e8f3ff;
            margin-top:25px;
        }
        .footer p{
            margin:6px 0;
            font-size:14px;
        }
        .footer a{
            color:white;
            text-decoration:none;
            margin:0 6px;
            font-size:15px;
            font-weight:bold;
        }

        @media(max-width:480px){
            .header h1{
                font-size:18px;
            }
            .nav-link{
                font-size:13px;
                margin-left:10px;
            }
        }
    </style>
</head>

<body>

    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

    <script>
        const loginButtonDiv = document.getElementById('login-button');

        // Header ના UI ને અપડેટ કરવા માટેનું ફંક્શન
        function updateHeader(user) {
            if (!loginButtonDiv) return;

            if (!user) {
                // લોગ-આઉટ સ્ટેટ (LOGIN / REGISTER બટન બતાવો)
                loginButtonDiv.innerHTML = `
                    <a href="#" onclick="netlifyIdentity.open(); return false;" class="nav-link">
                        LOGIN / REGISTER
                    </a>
                `;
            } else {
                // લોગ-ઇન સ્ટેટ (નામ અને LOGOUT બટન બતાવો)
                const userName = user.email.split('@')[0];
                loginButtonDiv.innerHTML = `
                    <span class="nav-link" style="margin-left:0;">${userName}</span>
                    <a href="#" onclick="netlifyIdentity.logout(); return false;" class="nav-link">
                        LOGOUT
                    </a>
                `;
            }
        }

        // Q2 FIX: પેજ લોડ થવા પર યુઝરનું સત્ર (Session) ચેક કરો
        // આ ખાતરી કરે છે કે રિફ્રેશ પછી યુઝર લોગ-આઉટ ન થાય.
        netlifyIdentity.on("init", user => {
            updateHeader(user);
        });

        // યુઝર સફળતાપૂર્વક લોગ-ઇન થાય ત્યારે હેડર અપડેટ કરો
        netlifyIdentity.on("login", user => {
            updateHeader(user);
            // જો તમે પોપઅપ બંધ કરવા માંગતા હો તો:
            // netlifyIdentity.close(); 
        });

        // Q3 FIX: યુઝર લોગ-આઉટ બટન ક્લિક કરે ત્યારે હેડર અપડેટ કરો
        netlifyIdentity.on("logout", () => {
            updateHeader(null);
        });
        
        // જો init ઇવેન્ટ ન ચાલે (જેમ કે જ્યારે DOM લોડ થાય), તો પણ શરૂઆતનું બટન બતાવો
        if (loginButtonDiv && !netlifyIdentity.currentUser()) {
             loginButtonDiv.innerHTML = `
                <a href="#" onclick="netlifyIdentity.open(); return false;" class="nav-link">
                    LOGIN / REGISTER
                </a>
            `;
        }
    </script>
    
    <div class="header">
        <h1>STI Mock Test</h1>
        <div id="login-button">
            <a href="#" class="nav-link">LOGIN</a> 
        </div>
    </div>
    
    <div class="container">

        <div id="demo" class="test-block">
            <h2>⭐ Demo Test - ફ્રી એક્સેસ</h2>
            <p>આ ડેમો ટેસ્ટ છે. તમે અહીં મફતમાં ટેસ્ટ આપી શકો છો અને સિસ્ટમની કાર્યક્ષમતા ચકાસી શકો છો.</p>
            <a href="demo-test-page.html" class="btn btn-success">DEMO Test શરુ કરો</a>
        </div>

        <div id="test-1" class="test-block">
            <h2>Test Series Paper 1: PSI/ASI</h2>
            <p>આ પેપર PSI/ASI પરીક્ષાના નવીનતમ અભ્યાસક્રમ મુજબ છે. કિંમત: ₹99/-</p>

            <button class="btn btn-accent" onclick="openCashfreePayment('Paper 1', 99)">
                Buy Now (₹99)
            </button>
        </div>

    <div class="footer">
        <p><strong>© 2025 STI Mock Test</strong></p>
        <p>All rights reserved.</p>
        <p>
            <a href="https://wa.me/916353511804" target="_blank">WhatsApp</a> |
            <a href="tel:+916353511804">Call 6353511804</a>
        </p>
    </div>

    <script>
        function openCashfreePayment(item_name, item_price) {
            alert(`તમે ${item_name} માટે ₹${item_price}/- ચૂકવણી કરી રહ્યા છો.\n\nઅહીં Cashfree Payment Integration આવશે.`);
        }
    </script>

</body>
</html>
